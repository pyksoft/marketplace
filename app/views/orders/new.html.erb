<h1>Your Order</h1>

<%#= render 'form', order: @order %>
<%= @shopping_cart_hash %>

<table>
  <thead>
    <tr>
      <th>User</th>
      <th>Product</th>
      <th>Price</th>
      <th colspan="1"></th>
    </tr>
  </thead>

  <tbody>
    <% @shopping_cart.products.each do |shopping_cart_item| %>
      <tr>
        <td><%= shopping_cart_item.seller.profile.full_name %></td>
        <td><%= shopping_cart_item.name %></td>
        <td><%= shopping_cart_item.price %></td>
        <td><%#= link_to 'Destroy', shopping_cart, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<!-- Checkout button -->
<%= form_with model: @order, method: :create, local: true do |f| %>
<%= hidden_field_tag 'authenticity_token', form_authenticity_token %>
<%= f.hidden_field :buyer_id, value: current_user.id if user_signed_in? %>
<%#= hidden_field_tag 'shopping_cart_hash', @shopping_cart_hash %>
<script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
data-description="Comic Culture Marketplace"
data-email="<%= current_user.email %>"
data-amount="<%= @amount %>"
data-currency="aud"
data-locale="auto"></script>
<% end %>

<%= link_to 'Back', shopping_carts_path %>
